# Fondements de React

Présentation par Éric Côté

[React Academy](https://www.reactAcademy.live/)

---

### Eric Côté

<img
  src='https://www.reactacademy.live/static/20616643d8afc491bd4c1817ae69db63/5a6cd/Eric_Cote.webp'
  alt='Eric Côté'
  title='Eric Côté'
  width='400px'
/>

- a débuté sur des machines 8-bit (Commodore 64)
- Formateur technique depuis 2001 (.NET, C#, ASP.NET MVC, SQL Server, Azure)
- Formateur sur les technologies Open Source depuis 2018
  - Javascript, TypeScript, React, GitHub, REST, Node, Express, Next, Remix, etc.
- Propriétaire de React Academy Live

---

### React Academy Live

<div>

<img
  src='/img/logoReact.svg'
  style={{ float: 'left', width: '300px', marginRight: '40px' }}
/>

Formations en entreprise, ainsi qu'en virtuel
pour apprendre et maîtriser les technologies web modernes:
**React, TypeScript, Next** et **Remix**.

Offre de la formation depuis 2018.

**Nouveau:** Nous avons remplacé CRA (Create-React-App) par **Vite**

**Nouveau:** Nous utilisons maintenant **TypeScript** sur tous nos exemples (plutôt que JS)

</div>

---

### Présentations

- Nom
- Travail (compagnie, poste, type de travail)
- Expérience en technologie
- Type de PC (Mac, Windows, Linux)
- Langages de programmation (JavaScript? Python? autre?)
- Expérience Web (Débutant? Avancé?)
- Expérience avec une technologie SPA (Aucune? React? Angular? Vue? Svelte?)
- Expérience à batir un service Backend (ASP.NET Web API? Azure Functions? Python Flask? AWS Lambda? Autre?)
- Attentes pour la formation (Que désirez-vous bâtir?)

---

### Qu’est-ce que React?

- “Une bibliothèque JavaScript pour créer des interfaces utilisateurs”
- Modèle déclaratif où les vues sont décrites en JSX
- Découpage en composants réutilisables
- Permet le développement de SPA (Single Page Apps)
- Nécessite de convertir le JSX en JavaScript
- Il faut donc utiliser une _boîte à outil_ ou un _Framework_

---

### Historique de React

- Créé en 2011 par Jordan Walke chez Faceboook
  - Utilisé en 2012 pour réécrire Instagram.
- 2013: React devient Open Source
- 2015: React-Native permet de développer des apps mobiles
- 2017: React 16 (Fiber rendering)
- 2020: React 17 (Hooks)
- 2022: React 18 (Concurrent rendering)
- 2024: React 19 (Server components)

---

### React vient en différentes saveurs

- Plusieurs versions de rendu
  - React DOM génère du HTML (Le plus populaire)
  - React PDF génère des documents PDF
  - React Docx génère des documents Word
  - React Native génère des applications mobiles et tablettes (Android et iOS)
  - React TV génère des application télés
  - React VR génère des interfaces pour réalité virtuelle
  - React Unity génère des scènes 3D

https://github.com/chentsulin/awesome-react-renderer

---

### Bons points de React

- **Rétro-compatible** les nouvelles versions évitent de briser le code existant.
- **Populaire** utilisé par une grande majorité d'applications. Facile de trouver de l'aide.
- **Sans opinion** React se fout du routage, du chargement de données, des styles, etc.
- **SSR** Compatible avec le Server-Side Rendering
- **SSG** Compatible avec le Static-Site Generation
- **RSC** Compatible avec le React Server Components

---

## Mauvais points de React

- **Facile de faire du mauvais code** Il est facile de faire du code spaghetti en React
- **Certaines composantes ne sont pas compatibles antérieures ou postérieures** Il faut alors se mettre à jour
- **Il faut se faire des opinions** Il faut choisir une biblothèque de routage, une autre de chargement, une autre pour le caching, une autre pour les syles... C'est fatiguant!
- **Pas de conventions** Chaque application React a sa propre approche pour résoudre les problèmes

---

## Boîte à outils de React

- Il existe de nombreux outils pour générer une application React
- À une certaine époque, on devait générer l'outillage nous-même:
  - Gestionnaire de paquets/Package Manager (npm, yarn, pnpm)
  - Compilateur (Babel, Typescript, swc)
  - Bundler (WebPack, Parcel, esbuild, swc)
  - Minifieur (terser, swc)
  - Serveur Web (express)
  - Linter pour valider (ESLint)
  - Environnement de tests (Jest, Cypress)
  - MonoRepo (Nx, Turborepo)

---

### Boites à outils clé en main

- Aujourd'hui, on peut prendre des outils simples, ou des Framework évolués:
  - Create-React-App (2016-2023)
  - Vite
  - Gatsby
  - Next.js
  - Remix
  - T3
  - Epic Stack

---

### Environnement VS Code

- Voici les extensions utiles:

  - **ESLint** (dbaeumer.vscode-eslint): valide le code et les règles
  - **Prettier** (esbenp.prettier-vscode): formatte le code
  - **Simple React Snippets** (burkeholland.simple-react-snippets): insère des snippets de code
    - Snippets utiles:
      - **imr, imrs, imrse:** import React, \{useState, useEffect\}
      - **ffc, sfc:** Créer composants react
      - **uef, usf:** useEffect, useState

---

## Configurations VS Code (1/2)

- Configurations utiles:
- Utilisez `cmd-,` (ctrl-virgule) pour aller en mode 'settings'

  - **Editor:** Tab Size: 2 ou 4
  - **Editor:** Default Formatter: Prettier - `esbenp.prettier-vscode`
  - **Editor:** Format On Save: true
  - **Prettier:** Jsx Single Quote: true
  - **Prettier:** Single Quote: true
  - **Emmet:** Include Language: `"javascript": "javascriptreact"`

---

## Configurations VS Code (2/2)

- **MacOS seulement:** ajoutez Code dans le "path" du terminal et des lignes de commandes

  - il faut aller dans la commande d'édition

```
Shift-Command-P
Shell Command: Install 'code' command in PATH
```

- Quittez `code` et fermez toutes fenêtres de terminal
  - Les prochaines fenêtres de terminal auront le "path" bien configuré

---

### Nouveau projet Vite

Pour créer un nouveau dossier qui contient un nouveau projet nommé _monweb_:

```bash
> npm create vite@latest monweb -- --template react-swc
```

Alternative: On pourrait démarrer **vite** en mode interactif, avec une série de questions:

```bash
> npm create vite@latest
```

On se déplace vers le nouveau dossier et on peut ouvrir code dans le dossier courant (Le point (.) représente le dossier courant)

```bash
> cd monweb
> code .
```

---

## Anatomie du projet vite:

**Fichiers:**

- **.eslintrc.cjs** : configurations pour eslint (validateur js)
- **index.html** : Page d'accueil en html, vide
- **vite.config.js** : configurations pour vite
- **package.json** : configurations pour npm
- **package-lock.json** : référence npm des dépendances et sous-dépendances avec versions. **Ne pas toucher.** Utilisez _npm_ pour mettre à jour.

**Dossiers:**

- **node_modules** : contient les dépendances et sous-dépendances. **Ne pas toucher.** Utilisez `npm install` ou `npm update` pour rafraîchir.
- **src**: contient les fichiers .js, .css et .svg qui sont compilés par Vite.
- **public**: contient les fichiers qui sont inclus sans être modifiés par Vite. (png, pdf, etc)

---

## Éliminer les warnings de prop-types

En mode JS, il y a une règle du Linter qui demande d'ajouter des prop-types. Cette règle n'est pas tellement utile. [PropTypes aren’t commonly used in modern React.](https://legacy.reactjs.org/docs/typechecking-with-proptypes.html)

Pour éliminer cet avertissement inutile, on ajoute le code suivant dans le fichier `.eslintrc.cjs`.

```js eslint.jsx
  'rules': {
    'react/prop-types': 'off',
  }
```

---

### Démarrer le projet en mode dev

Les commandes suivantes doivent être lancées à la racine du projet. (La racine du projet, c'est où se trouve le fichier `package.json`)

D'abord, installez les dépendances du projet dans le dossier `node_modules`

```bash
npm install
```

Lancez le projet en mode dev:

```bash
npm run dev
```

Ceci démarre un **serveur web** en mode dev. Tapez `o` pour lancer votre navigateur vers: http://localhost:5173

---

### Fast Refresh (Hot Module Reload, HMR)

- Modifiez la ligne 19 de `src/app.jsx` et sauvegardez,
  - Vous verrez la mise-à-jour se faire automatiquement dans le navigateur, sans avoir besoin de cliquer sur _rafraîchir_.
- Cela s'appelle _Fast Refresh_ (ainsi que _Hot Module Reload_)
- Parfois, le _Fast Refresh_ échoue et il faut rafraîchir le navigateur manuellement en cliquant sur _rafraichir_
- _Fast Refresh_ n'est disponible qu'avec le mode dev.

---

### JSX

- JSX : _JavaScript eXtension_
- Façon déclarative de générer du HTML
- JSX ressemble beaucoup à du HTML
- JSX est plus strict que HTML (Similaire à XHTML)
- Utilisez le convertisseur suivant:
  https://transform.tools/html-to-jsx

---

### JSX est populaire

- JSX est popularisé la première fois par React
- C'est aussi adopté par d'autres générateurs:
  - **Preact** (Léger et compatible)
  - **Vue** (Versatile)
  - **Inferno** (Rapide)
  - **Svelte** (Productif)
  - **Solid** (Composable)
- JSX n'est pas intégré au standard JavaScript (Pas encore)

---

### JSX dans les coulises (1/2)

JSX est écrit par un programmeur:

```js
<h3 title='alarme'>L'alarme sonne à {alarmTime}</h3>
```

JSX est compilé par Babel (ou swc, etc):

```js
React.createElement('h3', { title: 'alarme' }, "L'alarme sonne à ", alarmTime);
```

---

### JSX dans les coulisses (2/2)

Après exécution, cela génère un **élément React** (un simple objet JS):

```js
{
  type: 'h3',
  props: {
    title: 'alarme',
    children: ["L'alarme sonne à ", alarmTime],
  },
  key: null,
  ref: null,
  $$typeof: Symbol.for('react.element'),
};
```

L'ensemble des éléments React génère une arborescence nommée **Virtual DOM**.

---

### Expérience de développement (DX)

Le JSX n'est pas géré par les navigateurs, il faut d'abord compiler (transpiler) le JSX en JS.

Pour compiler en mode dev et démarrer un serveur Web:

```bash
npm run dev
```

**Dev mode** active les éléments suivants:

- **Strict Mode**, où chaque composant est rendu 2 fois, pour valider la compatibilité avec le "rendu concurrent".
- **Profiler Mode**, mesure la performance des composants, activé par l'extension du navigateur "React Dev Tools".
- **Hot Module Reloading (HMR)**, permet la mise à jour du JavaScript dans l'application, sans avoir besoin de recharger la page.

---

### Compiler en production

```bash
npm run build
```

Ceci créé un nouveau dossier nommé `dist`. C'est ce dossier qu'il faut distribuer.

Le processus **Build**:

- Minifie le code JavaScript
- Ignore le _Strict Mode_, _Profiling_, etc.

---

### Démarrer la production

Pour démarrer un mini-serveur web local, pour tester le contenu de `dist`:

```bash
npm run preview
```

On peut alors taper `o` pour ouvrir le navigateur http://localhost:4173

**Note:**

- le serveur web Preview ne permet pas le _Hot Module Reloading_ (HMR)
- Si on modifie le JavaScript, il faut appeler **build** et **preview** pour voir les changements

---

### Déployer le projet

Il suffit d'utiliser n'importe quel hébergeur web statique et de copier le contenu du dossier `dist`.

Si vous ne savez pas quel hébergeur utiliser, nous recommandons Netlify (gratuit).

---

### Devoir #1

- Créer une nouvelle application React
- Consultez la documentation de Vite pour créer une application React avec SWC
- Modifiez le contenu du JSX généré dans app.js. Faites une page simple de bienvenue avec votre nom complet.
- Utilisez https://transform.tools/html-to-jsx pour convertir votre html
- Testez votre application avec la commande `npm run dev`
- Naviguez vers: `http://localhost:5173`
- Créez votre application "finale" avec la commande `npm run build`
- Ceci va créer un nouveau dossier `dist`
- Validez votre application "finale" avec la commande `npm run preview`
- Naviguez vers: `http://localhost:4173`
- Déployez le dossier `dist` vers un hébergeur de site web statique et partagez à vos amis.
- Si vous n'avez pas d'hébergeur, nous vous recommandons Netlify (gratuit).

---

## Questions?

<img
  src='/img/job.jpeg'
  style={{ marginLeft: 'auto', marginRight: 'auto', width: '50%' }}
/>
